---

# **Slackタスクリマインダー (Slack Task Reminder)**

Googleスプレッドシートに記載されたタスクの期限を監視し、未完了の担当者に対してSlackでリマインドを自動送信するGoogle Apps Script（GAS）プロジェクトです。

## **主な機能**

* **期限前リマインド**: スプレッドシートの指定した期限の**3日前**にリマインドを送信します。  
* **条件判定**: タスクのステータスが「完了」となっている担当者はリマインドの対象外となります。  
* **メンション通知**: Slackのメンション（\<@username\>）付きで通知するため、担当者が気づきやすくなります。  
* **自動実行**: GASのトリガー機能を利用して、毎日決まった時間に自動でチェックと通知を実行します。

## **必要なもの**

* Googleアカウント  
* Slackワークスペースと、Incoming Webhookを追加できる権限

## **セットアップ手順**

### **1\. Slackの準備：Incoming Webhook URLの取得**

GASからSlackに通知を送信するための接続用URLを取得します。

1. [Slack Appの作成ページ](https://api.slack.com/apps)にアクセスし、「Create New App」をクリックします。  
2. 「From scratch」を選択し、アプリ名（例: タスクリマインダー）と対象のワークスペースを指定してアプリを作成します。  
3. 左メニューの「**Incoming Webhooks**」を選択し、機能を「**On**」にします。  
4. ページ下部の「**Add New Webhook to Workspace**」をクリックし、通知を投稿したいチャンネルを選択します。  
5. 生成されたWebhook URL（https://hooks.slack.com/services/...）をコピーします。**このURLは後ほど使用します。**

### **2\. Googleスプレッドシートの準備**

タスク管理用のスプレッドシートを用意します。以下の構成でシートを作成してください。

| 列 | 内容 | 備考 |
| :---- | :---- | :---- |
| **A** | タスク名（任意） | A1セルに入力したタスク名はリマインドメッセージに使用されます。 |
| **C** | **Slackのメンバー名** | **重要:** @を除いた名前（例: g.tanaka）を記入してください。 |
| **E** | **ステータス** | 完了と入力されている行はリマインド対象外となります。 |
| **I2** | **タスク全体の期限** | YYYY/MM/DD形式で日付を入力します。（例: 2025/10/31） |

### **3\. Google Apps Scriptの設定**

1. 上記で準備したスプレッドシートを開き、メニューから拡張機能 \> Apps Scriptを選択してスクリプトエディタを開きます。  
2. エディタに表示されている既存のコードをすべて削除し、提供された\*.gsファイルの中身を貼り付けます。  
3. コード内の設定項目を編集します。  
   JavaScript  
   // \====== 設定項目 \======

   const SLACK\_WEBHOOK\_URL \= '＊＊＊＊＊＊';

   const SHEET\_NAME \= 'シート1'; 

4. フロッピーディスクのアイコン（プロジェクトを保存）をクリックして保存します。

### **4\. トリガーの設定（自動実行）**

スクリプトを毎日自動で実行するためにトリガーを設定します。

1. スクリプトエディタの左メニューにある時計のアイコン（トリガー）をクリックします。  
2. 右下の「トリガーを追加」ボタンをクリックします。  
3. 以下の通りに設定し、「保存」をクリックします。  
   * **実行する関数を選択**: checkTaskDeadlineAndSendReminder  
   * **実行するデプロイを選択**: Head  
   * **イベントのソースを選択**: 時間主導型  
   * **時間ベースのトリガーのタイプを選択**: 日付ベースのタイマー  
   * **時刻を選択**: 午前8時～9時など、毎日チェックしたい時間帯

### **5\. 初回実行と承認**

トリガーを初めて保存する際や、手動で初回実行する際に、Googleアカウントへのアクセス許可を求める認証画面が表示されます。画面の指示に従い、スクリプトの実行を許可してください。（「安全でないページ」といった警告が表示された場合は、「詳細」→「プロジェクト名（安全でないページ）に移動」を選択して許可を進めてください。）

## **使い方**

上記の設定が完了すれば、設定したトリガーの時間（例: 毎日午前8時〜9時）になるとスクリプトが自動実行されます。
スプレッドシートの期限（I2セル）の3日前になると、ステータスが「完了」でない担当者全員にSlackでメンション付きのリマインドが送信されます。

## **スクリプトのカスタマイズ**

### **リマインド日数の変更**

リマインドを3日前ではなく5日前に変更したい場合など、日数を変更するにはコードの以下の行の数字を修正してください。

JavaScript

// 3日前のリマインド日付を計算
const reminderDate \= new Date(deadline);
reminderDate.setDate(deadline.getDate() \- 3); // ここの「3」を変更したい日数に修正  
