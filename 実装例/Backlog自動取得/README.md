# **Backlog課題Googleスプレッドシート連携スクリプト**

## **概要**

このGoogle Apps Script（GAS）は、Backlogプロジェクトの課題を定期的に取得し、指定したGoogleスプレッドシートに同期するためのスクリプトです。

## **主な機能**

* 特定のBacklogプロジェクトから課題情報を取得
* 課題の基本情報（ID, 課題キー, 件名, 完了予定日, ステータス）をシートに出力
* カスタムフィールドの値をIDで指定して取得・出力
* 実行時にシートを一度クリアし、最新の課題情報で上書き
* 毎日6~7時にBakclogから課題を取得

### **本プログラムの構成**
このプログラムは主に三つの関数から構成されています。
* getBacklogCustomField
   Backlogからカスタム属性のステータスを取得します。
   IDがあればカスタム属性のステータスは必要としないということが判明したため、現在この関数は利用していません。

* getCustomFieldList
   カスタム属性のIDを取得する関数です。
   こちらで取得したIDを利用し、syncBacklogIssuesにべた書きしています。

* syncBacklogIssues
   Backlogから情報を取得するメイン関数です。
   情報取得～SpreadSheetに起票までを行っています。

## **準備するもの**

1. **Googleアカウント**: GoogleスプレッドシートとGoogle Apps Scriptを利用できるアカウント
2. **Backlogアカウント**:
   * APIキー（個人設定から発行可能）
   * 対象プロジェクトのプロジェクトID
   * 取得したいカスタムフィールドのID

## **設定方法**

### **スプレッドシートの準備**

1. 新規にGoogleスプレッドシートを作成します。
2. シートの下部にあるタブの名前を、スクリプトで指定する名前（デフォルトでは Backlog連携テスト）に変更します。

### **Google Apps Scriptの設定**

1. 準備したスプレッドシートで、メニューの「拡張機能」\>「Apps Script」を選択し、スクリプトエディタを開きます。
2. エディタに表示されている初期コードをすべて削除し、提供された getBacklogIssues.gs のコードをすべて貼り付けます。
3. スクリプト上部の「▼▼▼ 設定項目 ▼▼▼」セクションを、ご自身の環境に合わせて編集します。

| 定数名 | 説明 | 設定例 |
| :---- | :---- | :---- |
| SPACE\_URL | BacklogスペースのURLです。 | 'https://your-space.backlog.com' |
| API\_KEY | Backlogの個人設定から発行したAPIキー。 | 'abc...xyz' |
| PROJECT\_ID | 対象プロジェクトのID（数値）。 | 12345 |
| TARGET\_STATUS\_IDS | 取得したい課題のステータスIDの配列。\[\]（空配列）にすると完了済みを含む**全ての課題**を取得します。 | \[1, 2, 3\] |
| HEADERS | スプレッドシートに出力する列のヘッダー名。**この順番通りに出力されます。** | \["ID", "課題キー", ...\] |
| CUSTOM\_FIELD\_ID\_MAPPING | スプレッドシートの列名: カスタムフィールドのID の形式で設定します。 | {'サイト種別': 486225} |
| TARGET\_SHEET\_NAME | 操作対象のスプレッドシートのタブ名。 | 'Backlog連携テスト' |

4. ファイルを保存します（フロッピーディスクのアイコンをクリック）。