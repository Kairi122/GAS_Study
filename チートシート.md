---

## **【付録】GASチートシート：明日から始めるスプレッドシート自動化**

### **1. スプレッドシートを操作するのに必要な関数まとめ**

JavaScript

function myFunction() {  
  // 1\. スプレッドシート（ブック全体）を取得  
  const ss \= SpreadsheetApp.getActiveSpreadsheet();  
    
  // 2\. シートを指定  
  const sheet \= ss.getSheetByName('シート名');  
    
  // 3\. セルを操作  
  sheet.getRange('A1').setValue('Hello, GAS\!');  
}

| メソッド | 説明 |
| :---- | :---- |
| SpreadsheetApp.getActiveSpreadsheet() | 現在アクティブなスプレッドシートを取得します。 |
| getSheetByName('シート名') | 指定した名前のシートを取得します。 |
| getRange('A1') | A1セルのような単一セル、または範囲を指定します。 |
| .getValue() / .getValues() | セル（単一/複数）の値を取得します。 |
| .setValue('値') / .setValues(\[\['値'\]\]) | セル（単一/複数）に値を書き込みます。 |

---

### **2. よく使う関数まとめ**

**セル・範囲の操作**

| メソッド | 説明 |
| :---- | :---- |
| sheet.getLastRow() | データが含まれる最終行の番号を取得します。 |
| sheet.getLastColumn() | データが含まれる最終列の番号を取得します。 |
| sheet.getRange(行, 列) | 行番号と列番号でセルを指定します。 (例: getRange(1, 1)) |
| sheet.getRange(行, 列, 行数, 列数) | 開始セルと行数・列数で範囲を指定します。 |
| range.getA1Notation() | A1のようなセル番地を文字列で取得します。 |
| range.clearContent() | セルの値だけをクリアします。 |
| range.copyTo(destination) | 指定した範囲にセルをコピーします。 |

**スプレッドシート・シートの操作**

| メソッド | 説明 |
| :---- | :---- |
| ss.insertSheet('新しいシート名') | 新しいシートを作成します。 |
| ss.deleteSheet(sheet) | シートを削除します。 |
| sheet.setName('新しい名前') | シートの名前を変更します。 |
| SpreadsheetApp.flush() | これまでの処理をスプレッドシートに即時反映させます。 |

**UI・メッセージ表示**

| メソッド | 説明 |
| :---- | :---- |
| SpreadsheetApp.getUi().alert('メッセージ') | シンプルな「OK」ボタン付きのアラートを表示します。 |
| Browser.msgBox('メッセージ') | 古い形式ですが、こちらもアラートを表示できます。 |
| SpreadsheetApp.getUi().prompt('質問', ui.ButtonSet.OK\_CANCEL) | 入力欄付きのダイアログを表示します。 |

---

### **3. 自動化を発想するためのヒント**

GASで自動化の発想をするための考え方

#### **視点1：繰り返し（ループ）を探す**

毎日、毎週、毎月やっている「同じ作業」はありませんか？

* **Before**: 複数人から送られてくる日報を、一つの管理シートに毎日手作業でコピペしている。  
* **After**: GASが自動で日報シートを巡回し、管理シートに転記する。**最終行を取得(getLastRow)して追記していく**  
* **Before**: 月末に各取引先の請求データをフィルタリングし、請求書テンプレートにコピペして数十社分作成している。  
* **After**: forループを使って、請求データリストの上から順に処理。ボタン一つで全社分の請求書PDFをGoogle Driveに保存する。

#### **視点2：きっかけ（トリガー）を探す**

「〇〇したら、××する」というルールはありませんか？

* **きっかけが「時間」の場合 → 時間主導型トリガー**  
  * **例1**: 毎朝9時に、今日のタスクリストを自分宛にメールで送る。  
  * **例2**: 毎週月曜日に、先週の売上データを集計してSlackに通知する。  
* **きっかけが「操作」の場合 → イベントトリガー**  
  * **例1**: フォーム回答用のスプレッドシートに**新しい行が追加されたら**(onFormSubmit)、担当部署にメールで通知する。  
  * **例2**: シートの**特定のセル（例: E2セル）が編集されたら**(onEdit)、編集日時をF列に自動で記録する。

#### **視点3：サービス間の「連携」を探す**

複数のGoogleサービスをまたいでいる作業はありませんか？

* **Googleフォーム → スプレッドシート → Gmail**  
  * フォームで受け付けた問い合わせ内容を、スプレッドシートで管理し、自動でサンクスメールを返信する。  
* **スプレッドシート ↔ Gmail**  
  * 未読の特定ラベルが付いたメールを検索し、添付ファイルを抽出し、スプレッドシートにファイル名とリンクを記録する。  
* **スプレッドシート → Googleカレンダー**  
  * 確定したイベントリスト（スプレッドシート）から、一括でGoogleカレンダーに予定を登録する。

---

### **4. トラブルシューティング**

1. **まずは console.log()**  
   * 変数の中身が想定通りか、処理がどこまで進んでいるかを確認する基本のデバッグ方法です。こまめにログを仕込み変数の中身や処理内容を確認していきましょう。  
2. **公式リファレンスを読む**  
   * ボリュームあるので面倒ですが、「こういう事がしたい」という英単語で検索すると、関連するクラスやメソッドが見つかります。  
   * [Google Apps Script 公式リファレンス](https://developers.google.com/apps-script/reference/spreadsheet)  
3. **エラー文でそのままググる**  
   * 遭遇したエラーは、世界の誰かも経験しています。エラーメッセージをコピーして検索すれば、解決策を見つけられることも多いです。生成AIに頼ることも良いですね。

---

